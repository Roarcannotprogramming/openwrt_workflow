name: Delete Old Build Artifacts
on: 
  workflow_dispatch:
  push:
  schedule:
    - cron: "0 21 * * *"

jobs:
  get_old_run_ids:
    runs-on: ubuntu-latest
    permissions:
      actions: read
    steps:
      run: |
      echo ${{ github.repository_owner }} ${{ github.event.repository.name }} 
#        curl -L \
#          -H "Accept: application/vnd.github+json" \
#          -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}"\
#          -H "X-GitHub-Api-Version: 2022-11-28" \
#          https://api.github.com/repos/${{ github.repository_owner }}/${{ github.event.repository.name }}/actions/runs \
#          | jq -r '.workflow_runs[] | select(.created_at < "'$(date -d "-7 day" +%Y-%m-%dT%H:%M:%SZ)'") | .id' \

  delete_run_ids:
    runs-on: ubuntu-latest
    permissions:
      actions: write
    steps:
      run: |
#         curl -L \
#           -X DELETE \
#           -H "Accept: application/vnd.github+json" \
#           -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}"\
#           -H "X-GitHub-Api-Version: 2022-11-28" \
#           https://api.github.com/repos/${{ github.repository_owner }}/${{ github.event.repository.name }}/actions/runs/RUN_ID